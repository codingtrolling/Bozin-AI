<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bozin AI | Local 2025 Edition</title>
    <style>
        :root { --primary: #007bff; --bg: #0b0f1a; --card: #161d2f; --text: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; }
        
        /* Auth/Login Box */
        #auth-box { position: fixed; background: var(--card); padding: 30px; border-radius: 15px; text-align: center; box-shadow: 0 0 20px rgba(0,0,0,0.5); z-index: 100; width: 320px; border: 1px solid #333; }
        #auth-box input { width: 90%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #0b0f1a; color: white; }
        #auth-box button { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 98%; font-weight: bold; }

        /* Chat UI */
        #chat-ui { width: 95%; max-width: 700px; height: 90vh; background: var(--card); border-radius: 20px; display: none; flex-direction: column; overflow: hidden; border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        header { padding: 15px 25px; background: #1c2537; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
        #messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        
        .msg { padding: 12px 18px; border-radius: 15px; max-width: 80%; line-height: 1.5; font-size: 1rem; word-wrap: break-word; }
        .user { background: var(--primary); align-self: flex-end; border-bottom-right-radius: 2px; }
        .ai { background: #2d3748; align-self: flex-start; border-bottom-left-radius: 2px; }

        .controls { padding: 20px; display: flex; gap: 10px; background: #1a202c; border-top: 1px solid #333; }
        input[type="text"] { flex: 1; padding: 14px; border-radius: 10px; border: none; background: #0b0f1a; color: white; outline: none; font-size: 1rem; }
        .btn { width: 50px; height: 50px; border-radius: 10px; border: none; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .mic { background: #e53e3e; color: white; }
        .send { background: var(--primary); color: white; }
        .btn:hover { opacity: 0.8; transform: scale(1.05); }
    </style>
</head>
<body>

<div id="auth-box">
    <h1 style="color:var(--primary); margin-top:0;">Bozin AI</h1>
    <p style="color:#aaa; font-size:0.9rem;">Local Access Portal</p>
    <input type="text" id="username" placeholder="Choose Username">
    <input type="password" id="password" placeholder="Password">
    <button onclick="handleAuth()">Login / Create Account</button>
</div>

<div id="chat-ui">
    <header>
        <span id="user-display" style="font-weight:bold; color:var(--primary);">Bozin AI</span>
        <span style="font-size:0.8rem; color:#666;">v2.5 Stable</span>
    </header>
    <div id="messages"></div>
    <div class="controls">
        <button class="btn mic" id="mic-btn" onclick="startVoice()">ðŸŽ¤</button>
        <input type="text" id="user-input" placeholder="Ask Bozin something...">
        <button class="btn send" onclick="sendToBozin()">âž¤</button>
    </div>
</div>

<script>
    // 1. YOUR API KEY
    const API_KEY = "AIzaSyAbJhRrN1RqNFuAyZk1Dz9XFNJQ8r4I2KY"; 

    // 2. LOCAL LOGIN LOGIC
    function handleAuth() {
        const u = document.getElementById('username').value.trim();
        const p = document.getElementById('password').value.trim();
        if(!u || !p) return alert("Please enter a username and password.");

        const savedPass = localStorage.getItem('bozin_user_' + u);
        if(savedPass && savedPass !== p) {
            alert("Incorrect password for this user.");
        } else {
            localStorage.setItem('bozin_user_' + u, p);
            document.getElementById('auth-box').style.display = 'none';
            document.getElementById('chat-ui').style.display = 'flex';
            document.getElementById('user-display').innerText = "User: " + u;
            addMsg('ai', `System Online. Welcome back, ${u}. I am Bozin AI.`);
        }
    }

    // 3. VOICE FEATURES
    function speak(text) {
        window.speechSynthesis.cancel();
        const speech = new SpeechSynthesisUtterance(text);
        window.speechSynthesis.speak(speech);
    }

    function startVoice() {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if(!SpeechRecognition) return alert("Voice not supported in this browser.");
        
        const recognition = new SpeechRecognition();
        const micBtn = document.getElementById('mic-btn');
        
        recognition.onstart = () => micBtn.innerText = "ðŸ›‘";
        recognition.onend = () => micBtn.innerText = "ðŸŽ¤";
        
        recognition.onresult = (event) => {
            document.getElementById('user-input').value = event.results[0][0].transcript;
            sendToBozin();
        };
        recognition.start();
    }

    // 4. THE CORE AI CONNECTION (Updated for 2025)
    async function sendToBozin() {
        const inputField = document.getElementById('user-input');
        const text = inputField.value.trim();
        
        if(!text) return;
        if(API_KEY === "YOUR_API_KEY_HERE") {
            alert("You must put your Gemini API Key in the code first!");
            return;
        }

        addMsg('user', text);
        inputField.value = "";
        const aiMsgDiv = addMsg('ai', "Bozin is thinking...");

        try {
            // Updated model name to gemini-2.5-flash for late 2025 compatibility
            const model = "gemini-2.5-flash";
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${API_KEY}`;
            
            const response = await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: text }] }],
                    systemInstruction: { parts: [{ text: "Your name is Bozin AI. You are a fast, smart, and futuristic assistant. Always refer to yourself as Bozin." }] }
                })
            });

            const data = await response.json();
            
            if(data.error) {
                aiMsgDiv.innerText = "API Error: " + data.error.message;
            } else {
                const reply = data.candidates[0].content.parts[0].text;
                aiMsgDiv.innerText = reply;
                speak(reply); // Bozin talks
            }
        } catch (error) {
            aiMsgDiv.innerText = "Connection failed. Make sure you are using Google Chrome or a local server.";
            console.error(error);
        }
    }

    function addMsg(role, text) {
        const container = document.getElementById('messages');
        const div = document.createElement('div');
        div.className = 'msg ' + role;
        div.innerText = text;
        container.appendChild(div);
        container.scrollTop = container.scrollHeight;
        return div;
    }
</script>

</body>
</html>
